(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53c41267"],{"0f28":function(e,t,a){},1202:function(e,t,a){},"15d8":function(e,t,a){},"15fd":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("b64b");function i(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}function n(e,t){if(null==e)return{};var a,n,r=i(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}},"225f":function(e,t,a){"use strict";a("15d8")},"24d2":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"b",(function(){return d}));var i=a("b775");function n(e){return Object(i["b"])({url:"/Project/GetList",method:"get",params:e})}function r(e){return Object(i["b"])({url:"/Project/GetPageList",method:"get",params:e})}function o(e){return Object(i["b"])({url:"/Project/GetListNoBundling",method:"get",params:e})}function l(e){return Object(i["b"])({url:"/Project/GetForm",method:"get",params:{Id:e}})}function s(e){return Object(i["b"])({url:"/Project/ApplySaveForm",method:"post",data:e})}function c(e){return Object(i["b"])({url:"/Project/SaveForm",method:"post",data:e})}function u(e){return Object(i["b"])({url:"/Project/Unbundling",method:"post",data:e})}function d(e){return Object(i["b"])({url:"/Project/DeleteForm",method:"post",data:e})}},"28b1":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"关键词",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.CompanyName,callback:function(t){e.$set(e.listQuery,"CompanyName",t)},expression:"listQuery.CompanyName"}}),a("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{placeholder:"状态",clearable:""},model:{value:e.listQuery.Status,callback:function(t){e.$set(e.listQuery,"Status",t)},expression:"listQuery.Status"}},e._l(e.statusOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(" 查询 ")]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(" 新增 ")]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v(" 导出 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":"",height:"72vh","header-cell-style":{"background-color":"rgba(245,245,245)"}},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"80"}}),a("el-table-column",{attrs:{label:"单位名称","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",{staticClass:"link-type",on:{click:function(t){return e.handleAction(i,"detail")}}},[e._v(e._s(i.CompanyName))])]}}])}),a("el-table-column",{attrs:{label:"注册地址"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.RegisteredAddr))])]}}])}),a("el-table-column",{attrs:{label:"联系人",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(i.Contacts))]),a("div",[e._v(e._s(i.Contactstel))])]}}])}),a("el-table-column",{attrs:{label:"在监项目个数",align:"center",width:"115"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.ProjectCount?a("span",{staticClass:"link-type",on:{click:function(t){return e.handleFetchProject(i.Id)}}},[e._v(e._s(i.ProjectCount))]):a("span",[e._v("0")])]}}])}),a("el-table-column",{attrs:{label:"监理人数",align:"center",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.SupervisorCount?a("span",{staticClass:"link-type",on:{click:function(t){return e.handleFetchPersonnel(i.Id)}}},[e._v(e._s(i.SupervisorCount))]):a("span",[e._v("0")])]}}])}),a("el-table-column",{attrs:{label:"状态","class-name":"status-col",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-tag",{attrs:{type:e._f("statusFilter")(i.Status)}},[e._v(" "+e._s(e.statusOptions[i.Status])+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleAction(i,"update")}}},[e._v(" 编辑 ")]),"1"!=i.Status?a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.handleModifyStatus(i,"1")}}},[e._v(" 暂停 ")]):e._e(),"0"!=i.Status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.handleModifyStatus(i,"0")}}},[e._v(" 恢复 ")]):e._e(),"已删除"!=i.Status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(i)}}},[e._v(" 删除 ")]):e._e()]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.PageIndex,limit:e.listQuery.PageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"PageIndex",t)},"update:limit":function(t){return e.$set(e.listQuery,"PageSize",t)},pagination:e.getList}}),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"110px"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:0}},[a("el-col",{attrs:{span:10,offset:1}},[a("el-form-item",{attrs:{label:"单位名称",prop:"CompanyName"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.CompanyName,callback:function(t){e.$set(e.temp,"CompanyName",t)},expression:"temp.CompanyName"}})],1),a("el-form-item",{attrs:{label:"组织机构代码",prop:"OrganizationCode"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus,maxlength:"9","show-word-limit":""},model:{value:e.temp.OrganizationCode,callback:function(t){e.$set(e.temp,"OrganizationCode",t)},expression:"temp.OrganizationCode"}})],1),a("el-form-item",{attrs:{label:"注册地址",prop:"RegisteredAddr"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.RegisteredAddr,callback:function(t){e.$set(e.temp,"RegisteredAddr",t)},expression:"temp.RegisteredAddr"}})],1),a("el-form-item",{attrs:{label:"法人",prop:"LegalPerson"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.LegalPerson,callback:function(t){e.$set(e.temp,"LegalPerson",t)},expression:"temp.LegalPerson"}})],1),a("el-form-item",{attrs:{label:"法人联系方式",prop:"Tel"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus,maxlength:"11","show-word-limit":""},model:{value:e.temp.Tel,callback:function(t){e.$set(e.temp,"Tel",t)},expression:"temp.Tel"}})],1),a("el-form-item",{attrs:{label:"联系人",prop:"Contacts"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.Contacts,callback:function(t){e.$set(e.temp,"Contacts",t)},expression:"temp.Contacts"}})],1),a("el-form-item",{attrs:{label:"联系方式",prop:"Contactstel"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus,maxlength:"11","show-word-limit":""},model:{value:e.temp.Contactstel,callback:function(t){e.$set(e.temp,"Contactstel",t)},expression:"temp.Contactstel"}})],1)],1),a("el-col",{staticClass:"upload-container",attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"资质证书",prop:"Certificate"}},[a("el-upload",{ref:"certificateUploader",staticClass:"avatar-uploader",attrs:{disabled:"detail"===e.dialogStatus,"list-type":"picture-card",action:e.uploadUrl,name:"file",limit:1,headers:e.headers,"show-file-list":!1,"auto-upload":!0,"on-preview":e.handlePreview,"on-success":e.handleCertificationSuccess,"on-error":e.handleCertificationError,"on-change":e.handleCertificationChange,"before-upload":e.beforeAvatarUpload,"before-remove":e.beforeRemove,"on-remove":e.handleRemove,"on-exceed":e.handleExceed}},[e.temp.CertificateUrl?a("el-image",{staticClass:"avatar",attrs:{src:e.temp.CertificateUrl}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]):"detail"===e.dialogStatus?a("i",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),"detail"!==e.dialogStatus?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传不超过5M的jpg图片 ")]):e._e()],1)],1),a("el-form-item",{attrs:{label:"营业执照",prop:"License"}},[a("el-upload",{ref:"licenseUploader",staticClass:"avatar-uploader",attrs:{disabled:"detail"===e.dialogStatus,"list-type":"picture-card",action:e.uploadUrl,name:"file",limit:1,headers:e.headers,"show-file-list":!1,"auto-upload":!0,"on-preview":e.handlePreview,"on-success":e.handleBusinessLicenseSuccess,"on-error":e.handleBusinessLicenseError,"on-change":e.handleBusinessLicenseChange,"before-upload":e.beforeAvatarUpload,"before-remove":e.beforeRemove,"on-remove":e.handleRemove,"on-exceed":e.handleExceed}},[e.temp.LicenseUrl?a("el-image",{staticClass:"avatar",attrs:{src:e.temp.LicenseUrl}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]):"detail"===e.dialogStatus?a("i",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),"detail"!==e.dialogStatus?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传不超过5M的jpg图片 ")]):e._e()],1)],1)],1)],1)],1),"detail"!==e.dialogStatus?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(" 确认 ")])],1):e._e()],1),a("el-dialog",{attrs:{visible:e.dialogPersonnelVisible,title:"监理人员",width:"70%"},on:{"update:visible":function(t){e.dialogPersonnelVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.personnelData,border:"",fit:"","highlight-current-row":"",height:"50vh"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"Name",label:"姓名",width:"90",align:"center"}}),a("el-table-column",{attrs:{prop:"PostCode",label:"岗位",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.getPostName(i.PostCode)))])]}}])}),a("el-table-column",{attrs:{prop:"CardId",label:"身份证号",width:"170",align:"center"}}),a("el-table-column",{attrs:{prop:"Tel",label:"联系方式",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"ProjectName",label:"所属项目"}}),a("el-table-column",{attrs:{prop:"CertificateStatusName",label:"证书状态",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-tag",{attrs:{type:e._f("certificateStatusFilter")(i.CertificateStatusName)}},[e._v(" "+e._s(i.CertificateStatusName)+" ")])]}}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogPersonnelVisible=!1}}},[e._v("确定")])],1)],1),a("el-dialog",{attrs:{visible:e.dialogProjectVisible,title:"在监项目",width:"70%"},on:{"update:visible":function(t){e.dialogProjectVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.projectData,border:"",fit:"","highlight-current-row":"",height:"50vh"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"ProjName",label:"项目名称",align:"center"}}),a("el-table-column",{attrs:{label:"项目类别",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.getProjectTypeName(i.ProjectTypeId)))])]}}])}),a("el-table-column",{attrs:{prop:"PhaseName",label:"项目阶段",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"项目状态",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-tag",{attrs:{type:e._f("projectStatusFilter")(i.StatusName)}},[e._v(" "+e._s(i.StatusName)+" ")])]}}])}),a("el-table-column",{attrs:{label:"项目负责人",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.Contact))])]}}])}),a("el-table-column",{attrs:{label:"所属区域"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.ProProvince+"/"+a.ProCity+"/"+a.ProjArea)+" ")]}}])}),a("el-table-column",{attrs:{label:"地点",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.ProjAddr))])]}}])}),a("el-table-column",{attrs:{label:"监理人数",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.SupervisorCount))])]}}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogProjectVisible=!1}}},[e._v("确定")])],1)],1),a("el-dialog",{attrs:{visible:e.dialogVisible,title:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-image",{attrs:{src:e.dialogImageUrl}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1)],1)},n=[],r=a("15fd"),o=a("5530"),l=(a("7db0"),a("d3b7"),a("3ca3"),a("ddb0"),a("99af"),a("2b3d"),a("b0c0"),a("d81d"),a("2f62")),s=a("b775"),c=a("61f7"),u=a("5f87"),d=a("fcac"),p=a("bc95"),f=a("24d2"),m=a("3f5e"),g=a("6724"),h=(a("ed08"),a("333d")),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"110px"}},[a("el-row",{staticStyle:{width:"100%"},attrs:{gutter:0}},[a("el-col",{attrs:{span:13,offset:1}},[a("el-form-item",{attrs:{label:"单位名称",prop:"CompanyName"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.CompanyName,callback:function(t){e.$set(e.temp,"CompanyName",t)},expression:"temp.CompanyName"}})],1),a("el-form-item",{attrs:{label:"组织机构代码",prop:"OrganizationCode"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.OrganizationCode,callback:function(t){e.$set(e.temp,"OrganizationCode",t)},expression:"temp.OrganizationCode"}})],1),a("el-form-item",{attrs:{label:"注册地址",prop:"RegisteredAddr"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.RegisteredAddr,callback:function(t){e.$set(e.temp,"RegisteredAddr",t)},expression:"temp.RegisteredAddr"}})],1),a("el-form-item",{attrs:{label:"法人",prop:"LegalPerson"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.LegalPerson,callback:function(t){e.$set(e.temp,"LegalPerson",t)},expression:"temp.LegalPerson"}})],1),a("el-form-item",{attrs:{label:"法人联系方式",prop:"Tel"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.Tel,callback:function(t){e.$set(e.temp,"Tel",t)},expression:"temp.Tel"}})],1),a("el-form-item",{attrs:{label:"联系人",prop:"Contacts"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.Contacts,callback:function(t){e.$set(e.temp,"Contacts",t)},expression:"temp.Contacts"}})],1),a("el-form-item",{attrs:{label:"联系方式",prop:"Contactstel"}},[a("el-input",{attrs:{readonly:"detail"===e.dialogStatus},model:{value:e.temp.Contactstel,callback:function(t){e.$set(e.temp,"Contactstel",t)},expression:"temp.Contactstel"}})],1)],1),a("el-col",{staticClass:"upload-container",attrs:{span:8,offset:1}},[a("el-form-item",{attrs:{label:"资质证书",prop:"Certificate"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:"detail"===e.dialogStatus,action:e.uploadUrl,name:"file",limit:"1",headers:e.headers,"show-file-list":!1,"auto-upload":!0,"on-preview":e.handlePreview,"on-success":e.handleCertificationSuccess,"on-error":e.handleCertificationError,"on-change":e.handleCertificationChange,"before-upload":e.beforeAvatarUpload,"before-remove":e.beforeRemove,"on-remove":e.handleRemove,"on-exceed":e.handleExceed}},[e.Certificate?a("img",{staticClass:"avatar",attrs:{src:e.Certificate}}):e._e(),"detail"!==e.dialogStatus?a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}):e._e(),"detail"===e.dialogStatus?a("i",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):e._e(),"detail"!==e.dialogStatus?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传不超过5M的jpg图片 ")]):e._e()])],1),a("el-form-item",{attrs:{label:"营业执照",prop:"License"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:"detail"===e.dialogStatus,action:e.uploadUrl,name:"file",limit:"1",headers:e.headers,"show-file-list":!1,"auto-upload":!0,"on-preview":e.handlePreview,"on-success":e.handleBusinessLicenseSuccess,"on-error":e.handleBusinessLicenseError,"on-change":e.handleBusinessLicenseChange,"before-upload":e.beforeAvatarUpload,"before-remove":e.beforeRemove,"on-remove":e.handleRemove,"on-exceed":e.handleExceed}},[e.License?a("img",{staticClass:"avatar",attrs:{src:e.License}}):e._e(),"detail"!==e.dialogStatus?a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}):e._e(),"detail"===e.dialogStatus?a("i",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):e._e(),"detail"!==e.dialogStatus?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传不超过5M的jpg图片 ")]):e._e()])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.sure}},[e._v(" 确认 ")])],1)],1)},v=[],C={props:{dialogStatus:{type:String,default:""},temp:{type:Object,default:null}},data:function(){return{rules:{timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],CompanyName:[{required:!0,message:"单位名称为必填项",trigger:"blur"}],OrganizationCode:[{required:!0,message:"组织机构代码为必填项",trigger:"blur"}],RegisteredAddr:[{required:!0,message:"注册地址为必填项",trigger:"blur"}],Contacts:[{required:!0,message:"联系人为必填项",trigger:"blur"}],Contactstel:[{required:!0,message:"联系方式为必填项",trigger:"blur"}],LegalPerson:[{required:!0,message:"法人为必填项",trigger:"blur"}],Tel:[{required:!0,message:"法人联系方式为必填项",trigger:"blur"}]}}},methods:{sure:function(){"create"===dialogStatus?this.createData():this.updateData()},cancel:function(){this.$emit("cancel")},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&Object(d["d"])(e.temp).then((function(){e.list.unshift(e.temp),e.dialogFormVisible=!1,e.$notify({title:"Success",message:"Created Successfully",type:"success",duration:2e3})}))}))}}},y=C,S=(a("b94f"),a("2877")),w=Object(S["a"])(y,b,v,!1,null,"734ceb48",null),F=w.exports,_={name:"CompanyIndex",components:{Pagination:h["a"],Company:F},directives:{waves:g["a"]},filters:{projectStatusFilter:function(e){var t={"未开始":"info","进行中":"success","已结束":""};return t[e]},statusFilter:function(e){var t=["success","info"];return t[e]},certificateStatusFilter:function(e){var t={"正常":"success","已过期":"danger"};return t[e]}},computed:Object(o["a"])({},Object(l["b"])(["dicts","projectTypes"])),data:function(){return{Posts:[],headers:{Authorization:"Bearer "+Object(u["b"])()},dialogImageUrl:"",dialogVisible:!1,uploadUrl:"",tableKey:0,list:null,total:0,listLoading:!0,listQuery:{CompanyName:"",PageIndex:1,PageSize:20,Status:void 0,title:void 0},statusOptions:["正常","已暂停"],sortOptions:[{label:"ID 升序",key:"+id"},{label:"ID 降序",key:"-id"}],temp:{CompanyName:"",OrganizationCode:"",RegisteredAddr:"",LegalPerson:"",Tel:"",Certificate:"",CertificateUrl:"",License:"",LicenseUrl:"",Contacts:"",Contactstel:"",Status:0,ProjectCount:0,SupervisorCount:0,Id:0},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"新增",detail:"监理单位详情"},dialogPersonnelVisible:!1,dialogProjectVisible:!1,personnelData:[],projectData:[],rules:{CompanyName:[{required:!0,message:"单位名称为必填项",trigger:"blur"}],OrganizationCode:[{required:!0,message:"组织机构代码格式不正确。",trigger:"blur",validator:function(e,t,a){t&&!Object(c["f"])(t)?a(new Error("组织机构代码格式不正确。")):a()}}],RegisteredAddr:[{required:!0,message:"注册地址为必填项",trigger:"blur"}],Contacts:[{required:!0,message:"联系人为必填项",trigger:"blur"}],Contactstel:[{required:!0,message:"手机号格式不正确",trigger:"blur",validator:function(e,t,a){t&&!Object(c["g"])(t)?a(new Error("请输入正确的手机号")):a()}}],LegalPerson:[{required:!0,message:"法人为必填项",trigger:"blur"}],Certificate:[{required:!0,message:"资质证书必须上传",trigger:"blur"}],License:[{required:!0,message:"营业执照必须上传",trigger:"blur"}],Tel:[{required:!0,message:"手机号格式不正确",trigger:"blur",validator:function(e,t,a){t&&!Object(c["g"])(t)?a(new Error("请输入正确的手机号")):a()}}]},downloadLoading:!1}},created:function(){this.uploadUrl=s["a"]+"/File/UploadImg";var e=this.dicts.find((function(e){return"Post"==e.DictType}));e&&(this.Posts=e.Detail),this.getList()},methods:{getProjectTypeName:function(e){var t=this.projectTypes.find((function(t){return t.Id==e}));return t.Name},getPostName:function(e){var t=this.Posts.find((function(t){return t.DictKey==e}));return t?t.DictValue:""},getList:function(){var e=this;this.listLoading=!0,Object(d["c"])(this.listQuery).then((function(t){e.list=t.Data,e.total=t.Total,e.listLoading=!1})).catch((function(t){e.listLoading=!1}))},handleFilter:function(){this.listQuery.PageIndex=1,this.getList()},handleModifyStatus:function(e,t){var a=this,i=Object.assign({},e);i.Status=t,i.timestamp=+new Date(i.timestamp),Object(d["d"])(i).then((function(){a.getList(),a.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3})})).catch((function(e){a.$message({title:"失败",message:"操作失败",type:"error"})}))},sortChange:function(e){var t=e.prop,a=e.order;"id"===t&&this.sortByID(a)},sortByID:function(e){this.listQuery.sort="ascending"===e?"+id":"-id",this.handleFilter()},resetTemp:function(){this.temp={CompanyName:"",OrganizationCode:"",RegisteredAddr:"",LegalPerson:"",Tel:"",Certificate:"",CertificateUrl:"",License:"",LicenseUrl:"",Contacts:"",Contactstel:"",Status:0,ProjectCount:0,SupervisorCount:0,Id:0}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},saveImg:function(e){return!e.createSavedImg&&e.CertificateFileId&&e.LicenseFileId?new Promise((function(t,a){Promise.all([Object(m["c"])({Id:0,FileId:e.CertificateFileId,FileType:2,FileName:e.CertificateFileName,FileSize:e.CertificateFileSize}),Object(m["c"])({Id:0,FileId:e.LicenseFileId,FileType:2,FileName:e.LicenseFileName,FileSize:e.LicenseFileSize})]).then((function(a){console.log("准备工作完毕12"),console.log(a),e.Certificate=a[0].Data,e.License=a[1].Data,e.createSavedImg=!0,t(e)})).catch((function(){a()}))})):e.createSavedImg||!e.CertificateFileId||e.LicenseFileId?e.createSavedImg||e.CertificateFileId||!e.LicenseFileId?new Promise((function(t,a){console.log("准备工作完毕0"),t(e)})):new Promise((function(t,a){Object(m["c"])({Id:0,FileId:e.LicenseFileId,FileType:2,FileName:e.LicenseFileName,FileSize:e.LicenseFileSize}).then((function(a){console.log("准备工作完毕2"),console.log(a),e.License=a.Data,e.createSavedImg=!0,t(e)})).catch((function(){a()}))})):new Promise((function(t,a){Object(m["c"])({Id:0,FileId:e.CertificateFileId,FileType:2,FileName:e.CertificateFileName,FileSize:e.CertificateFileSize}).then((function(a){console.log("准备工作完毕1"),console.log(a),e.Certificate=a.Data,e.createSavedImg=!0,t(e)})).catch((function(){a()}))}))},createData:function(){var e=this;this.saveImg(this.temp).then((function(t){e.$refs["dataForm"].validate((function(a){if(a){t.CertificateFileId,t.CertificateFileName,t.CertificateFileSize,t.CertificateUrl,t.LicenseFileId,t.LicenseFileName,t.LicenseFileSize,t.LicenseUrl;var i=Object(r["a"])(t,["CertificateFileId","CertificateFileName","CertificateFileSize","CertificateUrl","LicenseFileId","LicenseFileName","LicenseFileSize","LicenseUrl"]);Object(d["d"])(i).then((function(){e.getList(),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"新增成功！",type:"success",duration:2e3})})).catch((function(t){e.$notify({title:"失败",message:"新增失败！",type:"error",duration:2e3})}))}}))}))},handleAction:function(e,t){var a=this,i={IdS:"".concat(e.Certificate,",").concat(e.License)};Object(m["a"])(i).then((function(i){var n=i.Data;if(a.temp=Object.assign({},e),n&&n.length>0){var r=n.find((function(t){return t.Id==e.Certificate})).FileId;a.$set(a.temp,"CertificateUrl",s["a"]+"/"+r);var o=n.find((function(t){return t.Id==e.License})).FileId;a.$set(a.temp,"LicenseUrl",s["a"]+"/"+o).FileId}a.dialogStatus=t,a.dialogFormVisible=!0,a.$nextTick((function(){a.$refs["dataForm"].clearValidate()}))})).catch()},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=Object.assign({},e.temp);e.saveImg(a).then((function(t){Object(d["d"])(t).then((function(){e.getList(),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"操作成功！",type:"success",duration:2e3})})).catch((function(t){e.$notify({title:"失败",message:"操作失败！",type:"error",duration:2e3})}))}))}}))},handleCertificationUpload:function(e){var t=this,a=new FormData;a.append("files",e.file),alert(a),Object(m["e"])(a).then((function(e){t.temp.Certificate=[],t.temp.Certificate.push(e.data.data)}))},handleBusinessLicenseUpload:function(e){var t=this,a=new FormData;a.append("files",e.file),alert(a),Object(m["e"])(a).then((function(e){t.temp.License=[],t.temp.License.push(e.data.data)}))},handlePreview:function(e){console.log(e),this.dialogImageUrl=e.url,this.dialogVisible=!0},handleCertificationSuccess:function(e,t){this.temp.CertificateUrl=URL.createObjectURL(t.raw),this.temp.CertificateFileId=e.Data,this.temp.CertificateFileName=t.name,this.temp.CertificateFileSize=t.size,this.$refs.certificateUploader.clearFiles(),console.log("handleCertificationSuccess.res",e),console.log("handleCertificationSuccess.file",t),console.log("temp",this.temp)},handleBusinessLicenseSuccess:function(e,t){this.temp.LicenseUrl=URL.createObjectURL(t.raw),this.temp.LicenseFileId=e.Data,this.temp.LicenseFileName=t.name,this.temp.LicenseFileSize=t.size,this.$refs.licenseUploader.clearFiles(),console.log("handleBusinessLicenseSuccess.res",e),console.log("handleBusinessLicenseSuccess.file",t),console.log("temp",this.temp)},handleCertificationError:function(e,t,a){},handleBusinessLicenseError:function(e,t,a){},handleCertificationChange:function(e,t){},handleBusinessLicenseChange:function(e,t){},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},beforeRemove:function(e,t){return!0},handleRemove:function(e,t){console.log(file,t),0==t.length&&(this.baseDataRules.contractUrl=[{required:!0,message:"请上传合同",trigger:"change"}]),this.hideUpload=t.length>=1},handleExceed:function(e,t){console.log(e,t)},handleDelete:function(e){var t=this;this.$confirm("此操作将删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(a){Object(d["a"])({Ids:e.Id}).then((function(e){t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),t.getList()})).catch((function(e){t.$notify({title:"失败",message:"删除失败！",type:"error",duration:2e3})}))})).catch((function(e){}))},handleFetchPersonnel:function(e){var t=this;Object(p["c"])({SuperviseId:e}).then((function(e){t.personnelData=e.Data,t.dialogPersonnelVisible=!0}))},handleFetchProject:function(e){var t=this;Object(f["c"])({SuperviseComId:e}).then((function(e){t.projectData=e.Data,t.dialogProjectVisible=!0}))},handleDownload:function(){var e=this;this.downloadLoading=!0,Promise.all([a.e("chunk-0143048a"),a.e("chunk-2133cd4f")]).then(a.bind(null,"4bf8")).then((function(t){var a=["单位名称","注册地址","联系人","在监项目数","监理人数","状态"],i=["CompanyName","RegisteredAddr","Contacts","ProjectCount","SupervisorCount","Status"],n=e.formatJson(i);t.export_json_to_excel({header:a,data:n,filename:"监理单位列表"}),e.downloadLoading=!1}))},formatJson:function(e){var t=this;return this.list.map((function(a){return e.map((function(e){return"Status"===e?t.statusOptions[a[e]]:a[e]}))}))},getSortClass:function(e){var t=this.listQuery.sort;return t==="+".concat(e)?"ascending":"descending"}}},j=_,L=(a("e062"),Object(S["a"])(j,i,n,!1,null,"202b6b4d",null));t["default"]=L.exports},"333d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},n=[];a("a9e3");Math.easeInOutQuad=function(e,t,a,i){return e/=i/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,a){var i=l(),n=e-i,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var l=Math.easeInOutQuad(c,i,n,t);o(l),c<t?r(e):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&s(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&s(0,800)}}},u=c,d=(a("225f"),a("2877")),p=Object(d["a"])(u,i,n,!1,null,"4656909a",null);t["a"]=p.exports},6724:function(e,t,a){"use strict";a("8d41");var i="@@wavesContext";function n(e,t){function a(a){var i=Object.assign({},t.value),n=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),r=n.ele;if(r){r.style.position="relative",r.style.overflow="hidden";var o=r.getBoundingClientRect(),l=r.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":(l=document.createElement("span"),l.className="waves-ripple",l.style.height=l.style.width=Math.max(o.width,o.height)+"px",r.appendChild(l)),n.type){case"center":l.style.top=o.height/2-l.offsetHeight/2+"px",l.style.left=o.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(a.pageY-o.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(a.pageX-o.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=n.color,l.className="waves-ripple z-active",!1}}return e[i]?e[i].removeHandle=a:e[i]={removeHandle:a},a}var r={bind:function(e,t){e.addEventListener("click",n(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[i].removeHandle,!1),e.addEventListener("click",n(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[i].removeHandle,!1),e[i]=null,delete e[i]}},o=function(e){e.directive("waves",r)};window.Vue&&(window.waves=r,Vue.use(o)),r.install=o;t["a"]=r},"8d41":function(e,t,a){},b94f:function(e,t,a){"use strict";a("1202")},bc95:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return s})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var i=a("b775");function n(e){return Object(i["b"])({url:"/Supervisor/GetList",method:"get",params:e})}function r(e){return Object(i["b"])({url:"/Supervisor/GetPageList",method:"get",params:e})}function o(e){return Object(i["b"])({url:"/vue-element-admin/personnel/project",method:"get",params:{id:e}})}function l(e){return Object(i["b"])({url:"/Supervisor/SaveForm",method:"post",data:e})}function s(e){return Object(i["b"])({url:"/Supervisor/RecoveryForm",method:"post",data:e})}function c(e){return Object(i["b"])({url:"/Supervisor/BlacklistForm",method:"post",data:e})}function u(e){return Object(i["b"])({url:"/Supervisor/DeleteForm",method:"post",data:e})}},e062:function(e,t,a){"use strict";a("0f28")},fcac:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l}));var i=a("b775");function n(e){return Object(i["b"])({url:"/SuperviseCompany/GetList",method:"get",params:e})}function r(e){return Object(i["b"])({url:"/SuperviseCompany/GetPageList",method:"get",params:e})}function o(e){return Object(i["b"])({url:"/SuperviseCompany/SaveForm",method:"post",data:e})}function l(e){return Object(i["b"])({url:"/SuperviseCompany/DeleteForm",method:"post",data:e})}}}]);
//# sourceMappingURL=chunk-53c41267.68250015.js.map